## progress
1. deprecated the duplicates.
1. dumped the DB after (see archive)
1. moving on to quantity, which in STMML, ends up in the unitType. It causes a lot of confusion. I think the quantityExpression table is trying to do too much. you will need a sandbox for this - don't do it in production (yet)
1. created a sandbox with fks set to 'on update cascade' (all fks). mainly for large scale changes to quantities. 
1. normalize quantities (sandbox)
1. reassign some units

## exploring use of quantity expressions.


sql: 
```
SELECT q.name AS "Quantity", b.name AS "Base unit", ex.power 
FROM quantityExpression ex, baseQuantity b, quantity q
WHERE ex.quantityId = q.quantityId and ex.baseQuantityId = b.baseQuantityId
ORDER BY q.name asc, ex.power desc
```
see db_exports/select_quantity_baseUnit_power.csv
 

## quantities:
### summary:
- quantity  = property that can be measured. 
- unit = expressions of dimensions for quantities.

- different quantities can have the same dimensions. eg. mass concentration and mass density are both mass/volume. but 
  - mass concentration is a mixture (thing in the numerator and denominator are different), and 
  - mass density is not (same thing in numerator and denominator).

- Categorical measurements dont have quantities; eg, "red" is a category of colors, for a range of wavelengths. if you were to measure it quantitatively, you'd be reporting (probably) absorbance at some wavelength. 
 
- When a single unit is used by several different quantities; 
  - may be that they are similar but derived differently.
  - may have different entities 

the deriviation (or other complex description) does not belong in a unit dictionary. but example usage would be helpful 
### examples:
Some are pretty straightforward, and have only one set of dimensions. in general, quantities:units is many:many 
https://en.wikipedia.org/wiki/Concentration#Table_of_concentrations_and_related_quantities

one of wiki's refs (in statement that 'related quants', eg, mass fractions, are NOT concentrations).
http://goldbook.iupac.org/html/C/C01222.html

This is kind of a nice unit list: http://www.gordonengland.co.uk/conversion/sidef.htm
also has some groupings of units, along dimensions (see the conversions page). most of these are fine as is, but we need groupings like this for the biological units. physical units are easy. biological units not (sigh).



# 2018-03-05 - continued this week:
## wacky units and quantities:
some quantities are just plain wrong. explore how they got there for patterns. work in sandbox.

sql for every unit, its quantity and scope: 
```
SELECT q.name AS 'Quantity', u.name AS 'Unit', s.name AS 'Scope'  
FROM   mob_sandbox.quantity q, mob_sandbox.unit u, mob_sandbox.scope s, mob_sandbox.unitScope us
WHERE ( u.quantityId = q.quantityId and us.ScopeId = s.scopeId and us.unitId = u.unitId )
-- AND u.deprecatedTo IS NULL 
-- ORDER BY q.name asc, ex.power desc
```



sql for scopes that have contributed units, and how many:
```
SELECT  s.name AS 'Scope'  , count(*)
FROM   mob_sandbox.scope s, mob_sandbox.unitScope us
WHERE ( us.ScopeId = s.scopeId )
GROUP BY s.name
ORDER BY s.name
```

# 2018-03-19: 
## to do - working in sandbox
working with EML-2.1.0 scope:
1. add quantities, redefine quantities (e.g., flux to rate, where mis-described). consider adding a description column for quantities.
1. add units with consistent spelling
1. deprecate inconsistent to consistent
1. record usage of unit whose quantities you are editing.

In EML schema, the unit name serves as the referenced id. so it should be OK to reassign units to different quantities. you have some notes on how units are used in datasets; record these here, because the attribute determines the quantity, not the unit.

SQL to return everything from EML 2.1. 
```
SELECT q.name AS 'Quantity',u.unitId, u.name AS 'Unit', s.name AS 'Scope'  
FROM   mob_sandbox.quantity q, mob_sandbox.unit u, mob_sandbox.scope s, mob_sandbox.unitScope us
WHERE ( u.quantityId = q.quantityId and us.ScopeId = s.scopeId and us.unitId = u.unitId)
AND s.name LIKE 'EML-2.1%'
ORDER BY q.name
```
